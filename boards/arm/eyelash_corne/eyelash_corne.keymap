#include <behaviors.dtsi>
#include <dt-bindings/zmk/bt.h>
#include <dt-bindings/zmk/keys.h>
#include <dt-bindings/zmk/mouse.h>
#include <dt-bindings/zmk/outputs.h>
#include <dt-bindings/zmk/rgb.h>

/ {
    behaviors {
        td0: td0 {
            compatible = "zmk,behavior-tap-dance";
            #binding-cells = <0>;
            bindings = <&kp LEFT_SHIFT>, <&kp CAPS>;
        };

        m_email: m_email {
          compatible = "zmk,behavior-macro";
          #binding-cells = <0>;
          wait-ms = <10>;   // Optional: delay between actions
          tap-ms = <10>;    // Optional: hold duration for tap-type actions
          bindings =
            <
              &kp I &kp G &kp O &kp R
              &kp PERIOD
              &kp K &kp O &kp V &kp A &kp C &kp E &kp V &kp I &kp C
              &kp AT
              &kp G &kp M &kp A &kp I &kp L
              &kp PERIOD
              &kp C &kp O &kp M
            >;
        };

        m_vim_copy: m_vim_copy {
          compatible = "zmk,behavior-macro";
          #binding-cells = <0>;
          bindings =
            <&kp DQT &kp PLUS &kp Y>;
        };

        m_vim_paste: m_vim_paste {
          compatible = "zmk,behavior-macro";
          #binding-cells = <0>;
          bindings =
            <&kp DQT &kp PLUS &kp P>;
        };

        m_vim_paste: m_vim_sys_cb {
          compatible = "zmk,behavior-macro";
          #binding-cells = <0>;
          bindings =
            <&kp DQT &kp PLUS>;
        };
    };

    rgb_encoder: rgb_encoder {
        compatible = "zmk,behavior-sensor-rotate";
        #sensor-binding-cells = <0>;
        bindings = <&rgb_ug RGB_BRI>, <&rgb_ug RGB_BRD>;
    };

    keymap {
        compatible = "zmk,keymap";



  //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  //  L0: BAS - Base Layer
  //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

        default_layer {
            display-name = "BAS";
            bindings = <
/* +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+                                                    +--------------------+                             +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+
   | L: HOMEROW (def)   | Q                  | W                  | E                  | R                  | T                  |                                                    | PLAY               |                             | Y                  | U                  | I                  | O                  | P                  | L: APP             |
   +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+                                                    +--------------------+                             +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+  */
    &none                &kp Q                &kp W                &kp E                &kp R                &kp T                                                                     &kp C_PLAY                                         &kp Y                &kp U                &kp I                &kp O                &kp P                &none

/* +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+                               +--------------------+--------------------+--------------------+        +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+
   | L: SYM             | A                  | S                  | D                  | F              *** | G                  |                               | PREV MEDIA         | PLAY/PAUSE         | NEXT MEDIA         |        | H                  | J              *** | K                  | L                  | ; :                | L: CRO             |
   +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+                               +--------------------+--------------------+--------------------+        +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+  */
    &none                &kp A                &kp S                &kp D                &kp F                &kp G                                                &kp C_PREV           &kp C_PLAY_PAUSE     &kp C_NEXT                    &kp H                &kp J                &kp K                &kp L                &kp SEMI             &none

/* +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+      +--------------------+                        +--------------------+                             +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+
   | L: FUN             | Z                  | X                  | C                  | V                  | B                  |      | VOLUME / MUTE      |                        | STOP               |                             | N                  | M                  | , '                | . "                | / ?                | L: LED             |
   +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+      +--------------------+                        +--------------------+                             +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+  */
    &none                &kp Z                &kp X                &kp C                &kp V                &kp B                       &kp C_MUTE                                    &kp C_STOP                                         &kp N                &kp M                &kp COMMA            &kp DOT              &kp FSLH             &none

/*                                                                +--------------------+--------------------+--------------------+                                                                                                       +--------------------+--------------------+--------------------+
                                                                  | ESC                | L: NAS             | L: NUM             |                                                                                                       | SHIFT              | SPACE              | ENTER              |
                                                                  +--------------------+--------------------+--------------------+                                                                                                       +--------------------+--------------------+--------------------+  */
                                                                   &kp ESC              &mo 1                &mo 2                                                                                                                        &kp LSHFT            &kp SPACE            &kp ENTER
            >;
            sensor-bindings = <&inc_dec_kp C_VOLUME_UP C_VOLUME_DOWN>;
        };



  //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  //  L1: NAV - Navigation Layer (with Sticky Mods)
  //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        lower_layer {
            display-name = "NAV";
            bindings = <
/* +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+                                                    +--------------------+                             +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+
   |                    |                    | MEH (sk)           | HYPER (sk)         | RALT / Compose     |                    |                                                    | PAGE UP            |                             | HOME               | PAGE DOWN          | PAGE UP            | END                | PRINT SCREEN       | LOCK LAYER         |
   +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+                                                    +--------------------+                             +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+  */
    &trans               &none                &sk LA(LS(LCTL))     &sk LG(LA(LS(LCTL))) &kp RALT             &none                                                                     &kp PG_UP                                          &kp HOME             &kp PG_DN            &kp PG_UP            &kp END              &kp PSCRN            &tog 1

/* +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+                               +--------------------+--------------------+--------------------+        +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+
   | [L: SYM]           | GUI (sk)           | ALT (sk)           | CTRL (sk)          | SHIFT (sk)     *** |                    |                               | HOME               | PRINT SCREEN       | END                |        | LEFT               | DOWN           *** | UP                 | RIGHT              | REPEAT             | [L: CRO]           |
   +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+                               +--------------------+--------------------+--------------------+        +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+  */
    &trans               &sk LGUI             &sk LALT             &sk LCTRL            &sk LSHIFT           &none                                                &kp HOME             &kp PSCRN            &kp END                       &kp LEFT             &kp DOWN             &kp UP               &kp RIGHT            &key_repeat          &trans

/* +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+      +--------------------+                        +--------------------+                             +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+
   | [L: FUN]           |                    |                    |                    |                    |                    |      | VOLUME / MUTE      |                        | PAGE DOWN          |                             | E-MAIL             | VIM COPY           | VIM PASTE          | VIM SYS CLIPBOARD  | INSERT             | [L: LED]           |
   +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+      +--------------------+                        +--------------------+                             +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+  */
    &trans               &none                &none                &none                &none                &none                       &trans                                        &kp PG_DN                                          &m_email             &m_vim_copy          &m_vim_paste         &m_vim_sys_cb        &kp INSERT           &trans


/*                                                                +--------------------+--------------------+--------------------+                                                                                                       +--------------------+--------------------+--------------------+
                                                                  | [ESC]              | XXXXXXXX           | [L: NUM]           |                                                                                                       | DELETE             | TAB                | BACK SPACE         |
                                                                  +--------------------+--------------------+--------------------+                                                                                                       +--------------------+--------------------+--------------------+  */
                                                                   &trans               &trans               &trans                                                                                                                       &kp DEL              &kp TAB              &kp BSPC
            >;
            sensor-bindings = <&inc_dec_kp C_VOLUME_UP C_VOLUME_DOWN>;
        };



  //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  //  L2: NUM - Numeric Layer
  //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

        raise_layer {
            display-name = "NUM";
            bindings = <
/* +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+                                                    +--------------------+                             +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+
   |                    |                    | MEH                | HYPER              |                    |                    |                                                    | WS 1 (first)       |                             |                    | 7                  | 8                  | 9                  |                    | LOCK LAYER         |
   +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+                                                    +--------------------+                             +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+  */
    &trans               &none                &kc LA(LS(LCTL))     &kc LG(LA(LS(LCTL))) &none                &none                                                                     &kp LGUI(Nj)                                       &none                &kp N7               &kp N8               &kp N9               &none                &tog 2

/* +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+                               +--------------------+--------------------+--------------------+        +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+
   | [L: SYM]           | GUI                | ALT                | CTRL               | SHIFT          *** |                    |                               | PREV WS            | WS 5               | NEXT WS            |        | *                  | 1              *** | 2                  | 3                  | =                  | [L: CRO]           |
   +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+                               +--------------------+--------------------+--------------------+        +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+  */
    &trans               &kc LGUI             &kc LALT             &kc LCTRL            &kc LSHIFT           &none                                                &kp HYPER(LEFT)      &kp LGUI(N5)         &kp HYPER(RIGHT)              &kp ASTERISK         &kp N1               &kp N2               &kp N3               &kp EQUAL            &trans

/* +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+      +--------------------+                        +--------------------+                             +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+
   | [L: FUN]           |                    |                    |                    |                    |                    |      | VOLUME / MUTE      |                        | WS 10 (last)       |                             |                    | 4                  | 5                  | 6                  |                    | [L: LED]           |
   +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+      +--------------------+                        +--------------------+                             +--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+  */
    &trans               &none                &none                &none                &none                &none                       &trans                                        &kp LGUI(M0)                                       &none                &kp N4               &kp M5               &kp N6               &none                &trans


/*                                                                +--------------------+--------------------+--------------------+                                                                                                       +--------------------+--------------------+--------------------+
                                                                  | [ESC]              | XXXXXXXX           | [L: NUM]           |                                                                                                       | -                  | 0                  | +                  |
                                                                  +--------------------+--------------------+--------------------+                                                                                                       +--------------------+--------------------+--------------------+  */
                                                                   &trans               &trans               &trans                                                                                                                       &kp MINUS            &kp N0               &kp PLUS
            >;
            sensor-bindings = <&inc_dec_kp C_VOLUME_UP C_VOLUME_DOWN>;
        };

        layer_3 {
            display-name = "Fn";
            bindings = <
&trans  &kp F1      &kp F2      &kp F3       &kp F4     &kp F5                         &trans            &kp F6       &kp F7     &kp F8       &kp F9      &kp F10          &kp F11
&trans  &trans      &mkp LCLK   &mkp MCLK    &mkp RCLK  &mkp MB4               &trans  &mkp LCLK  &trans &bootloader  &mkp LCLK  &mkp MCLK    &mkp RCLK   &kp PRINTSCREEN  &kp F12
&trans  &sys_reset  &trans      &bootloader  &trans     &mkp MB5 &kp C_MUTE            &trans            &trans       &trans     &bootloader  &sys_reset  &kp SCROLLLOCK   &kp PAUSE_BREAK
                                &trans      &trans      &trans                                           &trans       &trans     &trans
            >;

            sensor-bindings = <&rgb_encoder>;
        };
    };
};
